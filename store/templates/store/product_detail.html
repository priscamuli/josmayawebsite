{% extends 'store/base.html' %}
{% load static %}
{% block title %}{{ product.name }}{% endblock %}

{% block content %}
<style>
  .product-page img {
    width: 100%;
    max-height: 400px;
    object-fit: cover;
    border-radius: 12px;
  }

  .product-info {
    padding: 20px;
  }

  .price-tag {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--primary-blue);
  }

  .add-btn {
    background-color: var(--dark-blue);
    color: white;
    border: none;
    padding: 10px 25px;
    border-radius: 8px;
  }

  .add-btn:hover {
    background-color: var(--accent-green);
    color: black;
  }

  .related-title {
    margin-top: 40px;
    font-weight: 700;
    font-size: 1.3rem;
  }

  .related img {
    width: 100%;
    height: 100px;
    object-fit: cover;
    border-radius: 8px;
  }
</style>

<div class="container py-5 product-page">
  <div class="row">

    <!-- Product Image -->
    <div class="col-md-6">
      <img src="{{ product.image.url }}" alt="{{ product.name }}">
    </div>

    <!-- Product Info -->
    <div class="col-md-6 product-info">
      <h2 class="fw-bold">{{ product.name }}</h2>
      <p class="price-tag">KES {{ product.price }}</p>

      <p class="text-muted">{{ product.description }}</p>

      {% if user.is_authenticated %}
      <form method="post" action="{% url 'add_to_cart' product.id %}">
        {% csrf_token %}
        <label class="fw-semibold">Quantity:</label>
        <input type="number" name="quantity" min="1" value="1" class="form-control w-25 mb-3">

        <button type="submit" class="add-btn">
          <i class="bi bi-cart-plus"></i> Add to Cart
        </button>
      </form>
      {% else %}
        <p><a href="{% url 'login' %}">Login</a> to add to cart.</p>
      {% endif %}
    </div>
  </div>

  <!-- Related Products Section -->
  <h3 class="related-title">Related Products</h3>
<div class="row related">
    {% for item in related_products %}
        <div class="col-md-3 mb-4">
            <a href="{% url 'product_detail' item.id %}" class="text-decoration-none text-dark">
              <img src="{{ item.image.url }}" class="mb-2">
              <p class="fw-semibold">{{ item.name|truncatechars:30 }}</p>
              <p class="text-primary fw-bold">KES {{ item.price }}</p>
            </a>
        </div>
    {% empty %}
        <p>No related products found.</p>
    {% endfor %}
</div>
</div>

{% endblock %}
